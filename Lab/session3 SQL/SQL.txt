CREATE TABLE DEPARTMENT(
DNAME VARCHAR(20) NOT NULL,
DNUMBER NUMBER NOT NULL,
PRIMARY KEY (DNUMBER));


CREATE TABLE EMPLOYEE(
NAME VARCHAR2(20) NOT NULL,
SSN NUMBER NOT NULL,
DOB DATE,
ADDRESS VARCHAR2(20),
SEX VARCHAR2(5),
SALARY INTEGER,
DEPT_NO NUMBER,
PRIMARY KEY(SSN),
FOREIGN KEY(DEPT_NO) REFERENCES DEPARTMENT(DNUMBER));

CREATE TABLE DEPT_LOCATIONS(
DNUMBER NUMBER NOT NULL,
DLOCATION VARCHAR2(20) NOT NULL,
PRIMARY KEY (DNUMBER,DLOCATION),
FOREIGN KEY (DNUMBER) REFERENCES DEPARTMENT(DNUMBER));

CREATE TABLE PROJECT(
PNAME VARCHAR2(20) NOT NULL,
PNUMBER NUMBER NOT NULL,
PLOCATION VARCHAR2(20) NOT NULL,
DNUMBER NUMBER NOT NULL,
PRIMARY KEY (PNUMBER),
FOREIGN KEY (DNUMBER) REFERENCES DEPARTMENT(DNUMBER));

CREATE TABLE WORKS_ON(
ESSN NUMBER NOT NULL,
PNUMBER NUMBER NOT NULL,
HOURS INTEGER NOT NULL,
PRIMARY KEY (ESSN,PNUMBER),
FOREIGN KEY (ESSN) REFERENCES EMPLOYEE(SSN),
FOREIGN KEY (PNUMBER) REFERENCES PROJECT(PNUMBER));


CREATE TABLE DEPENDANT(
ESSN NUMBER NOT NULL,
SERIAL NUMBER NOT NULL,
DEP_NAME VARCHAR2(20) NOT NULL,
SEX VARCHAR2(5),
DOB DATE,
RELATIONSHIP VARCHAR2(20),
PRIMARY KEY (ESSN,SERIAL),
FOREIGN KEY (ESSN) REFERENCES EMPLOYEE(SSN));

INSERT INTO DEPARTMENT
(DNAME,DNUMBER)
VALUES ('CSD',1);

INSERT INTO DEPARTMENT
(DNAME,DNUMBER)
VALUES ('ELEC',2);

INSERT INTO EMPLOYEE
(NAME,SSN,DOB,ADDRESS,SEX,SALARY,DEPT_NO)
VALUES('PETER',28,'23-JAN-1983','ALEXANDRIA','MALE',2000,1);

INSERT INTO EMPLOYEE
(NAME,SSN,DOB,ADDRESS,SEX,SALARY,DEPT_NO)
VALUES('MENA',68,'1-JAN-1981','ALEXANDRIA','MALE',1500,2);

INSERT INTO EMPLOYEE
(NAME,SSN,DOB,ADDRESS,SEX,SALARY,DEPT_NO)
VALUES('REHAM',9,'3-FEB-1983','ALEXANDRIA','FEM',1500,1);

INSERT INTO PROJECT
(PNAME,PNUMBER,PLOCATION,DNUMBER)
VALUES('project3',1,'ALEXANDRIA',2);

INSERT INTO PROJECT
(PNAME,PNUMBER,PLOCATION,DNUMBER)
VALUES('project2',2,'ALEXANDRIA',1);

INSERT INTO PROJECT
(PNAME,PNUMBER,PLOCATION,DNUMBER)
VALUES('project1',3,'ALEXANDRIA',1);

INSERT INTO DEPT_LOCATION
(DNUMBER,DLOCATION)
VALUES(1,'GAMAA');

INSERT INTO DEPT_LOCATION
(DNUMBER,DLOCATION)
VALUES(2,'CAMP SHEZAR');

INSERT INTO WORKS_ON
(ESSN,PNUMBER,HOURS)
VALUES(28,2,6);

INSERT INTO WORKS_ON
(ESSN,PNUMBER,HOURS)
VALUES(28,3,8);

INSERT INTO WORKS_ON
(ESSN,PNUMBER,HOURS)
VALUES(9,3,8);

INSERT INTO WORKS_ON
(ESSN,PNUMBER,HOURS)
VALUES(68,1,9);

SELECT * FROM EMPLOYEE;
SELECT * FROM DEPARTMENT;
SELECT * FROM

select avg(salary)
from employees;

select name,sum(hours)*salary
from employees,works_on
where ssn=essn
group by name;

select pn,c
from(select pname pn,count(essn) c
     from project,works_on where project.pnumber=works_on.pnumber
     group by pname)
where c=(select min(c)from(select pname pn,count(essn) c
    from project,works_on
    where project.pnumber=works_on.pnumber
    group by pname)) ;

